-- NVChad custom init to set core options as requested
local opt = vim.opt

-- Truecolor for better highlighting
opt.termguicolors = true

-- Ensure syntax highlighting and filetype detection/indentation
vim.cmd([[syntax on]])
vim.cmd([[filetype plugin indent on]])

-- Line numbers
opt.number = true
opt.relativenumber = false
vim.wo.number = true
vim.wo.relativenumber = false

-- Line indicators (ruler at 80) - draw a slightly thicker guide (80 and 81)
opt.colorcolumn = "80,81"
vim.api.nvim_set_hl(0, "ColorColumn", { bg = "#434C5E" })

-- Wrap and hard wrap at 80
opt.wrap = true
opt.textwidth = 80
opt.formatoptions:append("t")

-- Sensible defaults for indentation (overridden by ftplugins below)
opt.expandtab = true
opt.shiftwidth = 2
opt.tabstop = 2
opt.smartindent = true

-- Highlight current line and column
opt.cursorline = true
vim.wo.cursorline = true
opt.cursorcolumn = true
opt.cursorlineopt = "both"

-- Enforce line numbers and cursorline on new windows/buffers
vim.api.nvim_create_autocmd({"VimEnter","WinEnter","BufWinEnter"}, {
  callback = function()
    vim.wo.number = true
    vim.wo.relativenumber = false
    vim.wo.cursorline = true
  end,
})

-- Force highlight after colorscheme loads
vim.api.nvim_create_autocmd("ColorScheme", {
  callback = function()
    vim.api.nvim_set_hl(0, "CursorLine", { bg = "#3B4252" })
    vim.api.nvim_set_hl(0, "CursorLineNr", { fg = "#FFCC00", bold = true })
    vim.api.nvim_set_hl(0, "ColorColumn", { bg = "#434C5E" })
  end,
})

-- Also set highlights immediately and on VimEnter to ensure they stick
vim.api.nvim_set_hl(0, "CursorLine", { bg = "#3B4252" })
vim.api.nvim_set_hl(0, "CursorLineNr", { fg = "#FFCC00", bold = true })
vim.api.nvim_set_hl(0, "ColorColumn", { bg = "#434C5E" })

vim.api.nvim_create_autocmd("VimEnter", {
  callback = function()
    vim.api.nvim_set_hl(0, "CursorLine", { bg = "#3B4252" })
    vim.api.nvim_set_hl(0, "CursorLineNr", { fg = "#FFCC00", bold = true })
    vim.api.nvim_set_hl(0, "ColorColumn", { bg = "#434C5E" })
  end,
})

-- Make cursor block blink in normal mode (and shapes per mode)
vim.o.guicursor = table.concat({
  "n-v-c:block-blinkon500-blinkoff500",
  "i-ci:ver25-blinkon300-blinkoff300",
  "r-cr:hor20",
  "o:hor20",
  "sm:block-blinkon300-blinkoff300",
}, ",")


