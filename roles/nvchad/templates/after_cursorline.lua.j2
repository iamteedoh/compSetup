-- Force cursorline/number highlight after all plugins/themes load
vim.opt.number = true
vim.opt.relativenumber = false
vim.opt.cursorline = true
vim.opt.cursorcolumn = false
vim.opt.cursorlineopt = "both"

vim.api.nvim_set_hl(0, "CursorLine", { bg = "#3B4252" })
vim.api.nvim_set_hl(0, "CursorLineNr", { fg = "#FFCC00", bold = true })

-- Force-disable any vertical guides/columns set by themes/plugins
vim.opt.colorcolumn = ""
vim.api.nvim_set_hl(0, "ColorColumn", { bg = "NONE" })
vim.api.nvim_set_hl(0, "CursorColumn", { bg = "NONE" })

vim.api.nvim_create_autocmd({"VimEnter","WinEnter","BufWinEnter"}, {
  callback = function()
    vim.wo.colorcolumn = ""
  end,
})

-- Enforce 85 char auto-wrap on insert across filetypes after all configs
local function enforce_wrap_85()
  vim.opt_local.wrap = true
  vim.opt_local.textwidth = 85
  local fo = vim.api.nvim_get_option_value('formatoptions', { scope = 'local' })
  fo = fo:gsub('l','')
  if not fo:match('t') then fo = fo .. 't' end
  vim.api.nvim_set_option_value('formatoptions', fo, { scope = 'local' })
end

-- Run once now
pcall(enforce_wrap_85)

-- Re-run on typical events and after NVChad's VeryLazy
vim.api.nvim_create_autocmd({"BufEnter","InsertEnter","BufWinEnter","FileType","WinEnter"}, {
  callback = enforce_wrap_85,
})
vim.api.nvim_create_autocmd("User", {
  pattern = "VeryLazy",
  callback = enforce_wrap_85,
})


